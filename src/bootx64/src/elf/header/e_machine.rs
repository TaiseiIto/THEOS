// References
// https://refspecs.linuxfoundation.org/elf/elf.pdf
// https://en.wikipedia.org/wiki/Executable_and_Linkable_Format

#[derive(Debug)]
pub enum Machine {
    Unknown,
    AtTWe32100,
    Sparc,
    X86,
    Motorola68000,
    Motorola88000,
    IntelMcu,
    Intel80860,
    Mips,
    IbmSystem370,
    MipsRs3000LittleEndian,
    HewlettPackardPaRisc,
    Intel80960,
    Powerpc,
    Powerpc64,
    S390IncludingS390x,
    IbmSpuSpc,
    NecV800,
    FujitsuFr20,
    TrwRh32,
    MotorolaRce,
    Arm,
    DigitalAlpha,
    Superh,
    SparcVersion9,
    SiemensTricoreEmbeddedProcessor,
    ArgonautRiscCore,
    HitachiH8300,
    HitachiH8300h,
    HitachiH8s,
    HitachiH8500,
    Ia64,
    StanfordMipsX,
    MotorolaColdfire,
    MotorolaM68hc12,
    FujitsuMmaMultimediaAccelerator,
    SiemensPcp,
    SonyNcpuEmbeddedRiscProcessor,
    DensoNdr1Microprocessor,
    MotorolaStarCoreProcessor,
    ToyotaMe16Processor,
    StmicroelectronicsSt100Processor,
    AdvancedLogicCorpTinyjEmbeddedProcessorFamily,
    AmdX8664,
    SonyDspProcessor,
    DigitalEquipmentCorpPdp10,
    DigitalEquipmentCorpPdp11,
    SiemensFx66Microcontroller,
    StmicroelectronicsSt9816BitMicrocontroller,
    StmicroelectronicsSt78BitMicrocontroller,
    MotorolaMc68hc16Microcontroller,
    MotorolaMc68hc11Microcontroller,
    MotorolaMc68hc08Microcontroller,
    MotorolaMc68hc05Microcontroller,
    SiliconGraphicsSvx,
    StmicroelectronicsSt198BitMicrocontroller,
    DigitalVax,
    AxisCommunications32BitEmbeddedProcessor,
    InfineonTechnologies32BitEmbeddedProcessor,
    Element1464BitDspProcessor,
    LsiLogic16BitDspProcessor,
    Tms320c6000Family,
    McstElbrusE2k,
    Arm64,
    ZilogZ80,
    RiscV,
    BerkeleyPacketFilter,
    Wdc65c816,
}

impl From<u16> for Machine {
    fn from(machine: u16) -> Self {
        match machine {
            0x0000 => Self::Unknown,
            0x0001 => Self::AtTWe32100,
            0x0002 => Self::Sparc,
            0x0003 => Self::X86,
            0x0004 => Self::Motorola68000,
            0x0005 => Self::Motorola88000,
            0x0006 => Self::IntelMcu,
            0x0007 => Self::Intel80860,
            0x0008 => Self::Mips,
            0x0009 => Self::IbmSystem370,
            0x000a => Self::MipsRs3000LittleEndian,
            0x000e => Self::HewlettPackardPaRisc,
            0x0013 => Self::Intel80960,
            0x0014 => Self::Powerpc,
            0x0015 => Self::Powerpc64,
            0x0016 => Self::S390IncludingS390x,
            0x0017 => Self::IbmSpuSpc,
            0x0024 => Self::NecV800,
            0x0025 => Self::FujitsuFr20,
            0x0026 => Self::TrwRh32,
            0x0027 => Self::MotorolaRce,
            0x0028 => Self::Arm,
            0x0029 => Self::DigitalAlpha,
            0x002a => Self::Superh,
            0x002b => Self::SparcVersion9,
            0x002c => Self::SiemensTricoreEmbeddedProcessor,
            0x002d => Self::ArgonautRiscCore,
            0x002e => Self::HitachiH8300,
            0x002f => Self::HitachiH8300h,
            0x0030 => Self::HitachiH8s,
            0x0031 => Self::HitachiH8500,
            0x0032 => Self::Ia64,
            0x0033 => Self::StanfordMipsX,
            0x0034 => Self::MotorolaColdfire,
            0x0035 => Self::MotorolaM68hc12,
            0x0036 => Self::FujitsuMmaMultimediaAccelerator,
            0x0037 => Self::SiemensPcp,
            0x0038 => Self::SonyNcpuEmbeddedRiscProcessor,
            0x0039 => Self::DensoNdr1Microprocessor,
            0x003a => Self::MotorolaStarCoreProcessor,
            0x003b => Self::ToyotaMe16Processor,
            0x003c => Self::StmicroelectronicsSt100Processor,
            0x003d => Self::AdvancedLogicCorpTinyjEmbeddedProcessorFamily,
            0x003e => Self::AmdX8664,
            0x003f => Self::SonyDspProcessor,
            0x0040 => Self::DigitalEquipmentCorpPdp10,
            0x0041 => Self::DigitalEquipmentCorpPdp11,
            0x0042 => Self::SiemensFx66Microcontroller,
            0x0043 => Self::StmicroelectronicsSt9816BitMicrocontroller,
            0x0044 => Self::StmicroelectronicsSt78BitMicrocontroller,
            0x0045 => Self::MotorolaMc68hc16Microcontroller,
            0x0046 => Self::MotorolaMc68hc11Microcontroller,
            0x0047 => Self::MotorolaMc68hc08Microcontroller,
            0x0048 => Self::MotorolaMc68hc05Microcontroller,
            0x0049 => Self::SiliconGraphicsSvx,
            0x004a => Self::StmicroelectronicsSt198BitMicrocontroller,
            0x004b => Self::DigitalVax,
            0x004c => Self::AxisCommunications32BitEmbeddedProcessor,
            0x004d => Self::InfineonTechnologies32BitEmbeddedProcessor,
            0x004e => Self::Element1464BitDspProcessor,
            0x004f => Self::LsiLogic16BitDspProcessor,
            0x008c => Self::Tms320c6000Family,
            0x00af => Self::McstElbrusE2k,
            0x00b7 => Self::Arm64,
            0x00dc => Self::ZilogZ80,
            0x00f3 => Self::RiscV,
            0x00f7 => Self::BerkeleyPacketFilter,
            0x0101 => Self::Wdc65c816,
            _ => panic!("Can't read an ELF!"),
        }
    }
}

